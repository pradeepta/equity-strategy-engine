# Broker Configuration
BROKER=tws

# Trading mode: true=live, false=dry-run
LIVE=false

# TWS Configuration
TWS_HOST=127.0.0.1

TWS_PORT=7497

TWS_CLIENT_ID=0

TWS_ACCOUNT_ID=DU9999999

# TWS Market Data Type (1=Live, 2=Frozen, 3=Delayed, 4=Delayed-Frozen)
TWS_MARKET_DATA_TYPE=2

# Python TWS Bridge Server (recommended for reliable bar streaming)
# When enabled, ALL bar fetching (historical + real-time) routes through Python server
# Benefits: Reliable real-time updates, persistent connection, eliminates @stoqey/ib bugs
PYTHON_TWS_ENABLED=false
PYTHON_TWS_URL=http://localhost:3003

# AI Gateway for TradeCheck YAML Conversion
# The portfolio API now uses Claude Code via AI Gateway (with MCP tools) instead of Azure OpenAI
ACP_GATEWAY_URL=ws://localhost:8787/acp
ACP_CWD=/Users/pradeeptadash/stocks
MCP_SERVER_PATH=./dist/mcp-server.js

# TradeCheck API
TRADECHECK_API_URL=http://localhost:8000

# Database
DATABASE_URL="postgresql://pradeeptadash@localhost:5432/trading_db?schema=public"

USER_ID=default-user

# Multi-Strategy
STRATEGY_EVAL_WS_ENDPOINT=ws://localhost:8787/acp

# Enable/disable strategy evaluation completely (default: false, disabled)
STRATEGY_EVAL_ENABLED=false

# Only evaluate during market hours (9:30 AM - 4:00 PM ET, default: false)
STRATEGY_EVAL_MARKET_HOURS_ONLY=false

MAX_CONCURRENT_STRATEGIES=10

# Database poller: check for new PENDING strategies every N ms (default: 30000 = 30s)
STRATEGY_WATCH_INTERVAL_MS=30000

# Optional: Force main loop AND bar fetching to run every N ms, overriding strategy timeframes
# When set, strategies will test entry conditions at this interval regardless of their timeframe setting
# Useful for development/testing to see results faster (e.g., test a 5m strategy every 10s)
# Values < 60000ms (1 minute) automatically:
#   - Bypass bar cache and fetch fresh data from broker every loop
#   - Get latest completed bars for near-real-time strategy evaluation
# Example: ORCHESTRATOR_LOOP_INTERVAL_MS=10000 (runs every 10 seconds with fresh bar polling)
# Note: TWS keepUpToDate streaming is disabled due to API unreliability - polling is more robust
# ORCHESTRATOR_LOOP_INTERVAL_MS=10000

# Enable debug logging (shows detailed condition evaluation for failed transitions)
# DEBUG=true

# Bar Caching
BAR_CACHE_ENABLED=true

ENGINE_MAX_BAR_HISTORY=200

# ENGINE_MAX_FEATURE_HISTORY=100

# IBKR Web API
IBKR_WEB_BASE_URL=https://localhost:5002/v1/api
IBKR_WEB_ALLOW_INSECURE=true


# Risk Controls
ALLOW_LIVE_ORDERS=true

ALLOW_CANCEL_ENTRIES=false

# Max orders per symbol (optional)
# MAX_ORDERS_PER_SYMBOL=2

# Max order quantity (optional)
# MAX_ORDER_QTY=100

# Max notional per symbol (optional)
# MAX_NOTIONAL_PER_SYMBOL=100000

# Daily loss limit (optional)
# DAILY_LOSS_LIMIT=500

ALLOW_CROSS_SYMBOL_SWAP=true
